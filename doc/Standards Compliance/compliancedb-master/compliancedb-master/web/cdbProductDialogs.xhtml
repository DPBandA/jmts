<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">

    <h:form id="productDialogForm">
        <p:dialog width="700"
                  height="600"
                  modal="true"
                  draggable="true"    
                  closable="false"
                  widgetVar="productDialog"                  
                  header="Product Detail" >
            <p:commandButton value="Ok"
                             actionListener="#{complianceManager.okMarketProduct}"
                             onstart="longProcessDialogVar.show();"
                             oncomplete="productDialog.hide();longProcessDialogVar.hide();productDialogTabViewVar.select(0);"
                             update="#{complianceManager.productTablesToUpdate}"
                             icon="ui-icon ui-icon-check"
                             process="@form"/>

            <p:commandButton value="Cancel"
                             onstart="longProcessDialogVar.show();"
                             oncomplete="productDialog.hide();longProcessDialogVar.hide();productDialogTabViewVar.select(0);"                            
                             icon="ui-icon ui-icon-cancel"/>
            <hr/>
            <p:tabView id="productDialogTabView"
                       dynamic="false"
                       widgetVar="productDialogTabViewVar">
                <p:ajax event="tabChange"    
                        onstart="longProcessDialogVar.show();"
                        oncomplete="longProcessDialogVar.hide();"/>

                <p:tab title="Product detail">
                    <h:panelGrid columns="2" cellpadding="4" >

                        <h:outputText value="Name: " />
                        <p:inputText value="#{complianceManager.currentMarketProduct.name}"
                                     style="font-weight: bold;" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>                      

                        <h:outputText value="Brand: " />
                        <p:inputText value="#{complianceManager.currentMarketProduct.brand}"
                                     style="font-weight: bold;" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>        

                        <h:outputText value="Model: " />
                        <p:inputText value="#{complianceManager.currentMarketProduct.model}"
                                     style="font-weight: bold;" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>    

                        <h:outputText value="Serial #: " />
                        <p:inputText value="#{complianceManager.currentMarketProduct.serialNumber}"
                                     style="font-weight: bold;" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>   

                        <h:outputText value="Container #/Size): " />
                        <h:panelGroup>
                            <h:selectOneMenu value="#{complianceManager.currentMarketProduct.containerNumber}" >
                                <p:ajax
                                    global="true"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this" />
                                <f:selectItems value="#{complianceManager.currentComplianceSurvey.containerNumberList}" />
                            </h:selectOneMenu>
                            <h:outputText value="/" />
                            <p:inputText value="#{complianceManager.currentMarketProduct.containerSize}"
                                         style="font-weight: bold;" >
                                <p:ajax event="keyup"
                                        global="false"
                                        listener="#{complianceManager.updateJob}"
                                        process="@this"/>
                            </p:inputText>                           
                        </h:panelGroup>

                        <h:outputText value="Quantity: " />
                        <h:panelGroup>
                            <p:inputText value="#{complianceManager.currentMarketProduct.quantityText}"
                                         style="font-weight: bold;" >
                                <p:ajax event="keyup"
                                        global="false"
                                        listener="#{complianceManager.updateJob}"
                                        process="@this"/>
                            </p:inputText>
                            <h:outputText value=" Units: " />
                            <p:inputText value="#{complianceManager.currentMarketProduct.quantityUnit}"
                                         style="font-weight: bold;" >
                                <p:ajax event="keyup"
                                        global="false"
                                        listener="#{complianceManager.updateJob}"
                                        process="@this"/>
                            </p:inputText>
                        </h:panelGroup>

                        <h:outputText value="Sample size taken: " />
                        <h:panelGroup>
                            <p:inputText value="#{complianceManager.currentMarketProduct.sampleSizeText}"
                                         style="font-weight: bold;" >
                                <p:ajax event="keyup"
                                        global="false"
                                        listener="#{complianceManager.updateJob}"
                                        process="@this"/>
                            </p:inputText>  
                            <h:outputText value=" Units: " />
                            <p:inputText value="#{complianceManager.currentMarketProduct.sampleSizeUnits}"
                                         style="font-weight: bold;" >
                                <p:ajax event="keyup"
                                        global="false"
                                        listener="#{complianceManager.updateJob}"
                                        process="@this"/>
                            </p:inputText>
                        </h:panelGroup>

                        <h:outputText value="Sampled for: " />
                        <h:panelGrid columns="4">
                            <h:outputText value="Label Ass.: " />
                            <p:selectBooleanCheckbox value="#{complianceManager.currentMarketProduct.sampledForLabelAssessment}">
                                <p:ajax listener="#{complianceManager.updateJob}"/>
                            </p:selectBooleanCheckbox>
                            <h:outputText value="   Testing: " />
                            <p:selectBooleanCheckbox value="#{complianceManager.currentMarketProduct.sampledForTesting}">
                                <p:ajax listener="#{complianceManager.updateJob}"/>
                            </p:selectBooleanCheckbox>
                        </h:panelGrid>

                        <h:outputText value="Batch code: " />
                        <p:inputText value="#{complianceManager.currentMarketProduct.batchCode}"
                                     style="font-weight: bold;" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>

                        <h:outputText value="Date mark: " />
                        <p:inputText value="#{complianceManager.currentMarketProduct.dateMark}"
                                     style="font-weight: bold;" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>

                        <h:outputText value="Precaution statement:"  />
                        <p:inputTextarea value="#{complianceManager.currentMarketProduct.precautionStatement}"
                                         style="width: 350px"
                                         maxlength="1000"
                                         rows="1"
                                         autoResize="false">
                            <p:ajax event="keyup"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputTextarea>

                        <h:outputText value="Status:" />
                        <h:selectOneMenu value="#{complianceManager.currentMarketProduct.status}" >
                            <p:ajax
                                global="true"
                                listener="#{complianceManager.updateJob}"
                                process="@this" />
                            <f:selectItems value="#{complianceManager.productStatus}" />
                        </h:selectOneMenu>
                    </h:panelGrid>
                </p:tab>

                <p:tab title="Checklist">
                    <h:panelGrid columns="3" cellpadding="5">
                        <h:outputText value="Country of Origin: " />
                        <p:selectBooleanCheckbox value="#{complianceManager.currentMarketProduct.hasCountryOfOrigin}">
                            <p:ajax listener="#{complianceManager.updateJob}"/>
                        </p:selectBooleanCheckbox>

                        <h:selectOneMenu value="#{complianceManager.currentMarketProduct.countryOfOrigin}" >
                            <p:ajax                               
                                listener="#{complianceManager.updateJob}"
                                process="@this" />
                            <f:selectItems value="#{complianceManager.countries}" />
                        </h:selectOneMenu>
                        <ui:remove>
                            <p:inputText value="#{complianceManager.currentMarketProduct.countryOfOrigin}"
                                         style="font-weight: bold;width: 300px" >
                                <p:ajax event="keyup"
                                        global="false"
                                        listener="#{complianceManager.updateJob}"
                                        process="@this"/>
                            </p:inputText>
                        </ui:remove>

                        <h:outputText value="Name of 'Source': " />
                        <p:selectBooleanCheckbox value="#{complianceManager.currentMarketProduct.hasBusinessSource}">
                            <p:ajax listener="#{complianceManager.updateJob}"/>
                        </p:selectBooleanCheckbox>
                        <p:inputText value="#{complianceManager.currentMarketProduct.businessSource.name}"
                                     style="font-weight: bold;width: 300px" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>

                        <h:outputText value="Net Quantity Declaration in Metric: " />
                        <p:selectBooleanCheckbox value="#{complianceManager.currentMarketProduct.hasQuantityDescription}">
                            <p:ajax listener="#{complianceManager.updateJob}"/>
                        </p:selectBooleanCheckbox>
                        <p:inputText value="#{complianceManager.currentMarketProduct.quantityDescription}"
                                     style="font-weight: bold;width: 300px" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>

                        <h:outputText value="Ingredient Listing: " />
                        <p:selectBooleanCheckbox value="#{complianceManager.currentMarketProduct.hasIngredients}">
                            <p:ajax listener="#{complianceManager.updateJob}"/>
                        </p:selectBooleanCheckbox>
                        <p:inputTextarea value="#{complianceManager.currentMarketProduct.ingredients}"
                                         style="width: 300px"
                                         maxlength="1000"
                                         autoResize="false">
                            <p:ajax event="keyup"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputTextarea>

                        <h:outputText value="Instructions: " />
                        <p:selectBooleanCheckbox value="#{complianceManager.currentMarketProduct.hasInstructions}">
                            <p:ajax listener="#{complianceManager.updateJob}"/>
                        </p:selectBooleanCheckbox>
                        <p:inputTextarea value="#{complianceManager.currentMarketProduct.instructions}"
                                         style="width: 300px"
                                         maxlength="1000"
                                         autoResize="false">
                            <p:ajax event="keyup"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputTextarea>

                        <h:outputText value="Pictorial Representation: " />
                        <p:selectBooleanCheckbox value="#{complianceManager.currentMarketProduct.hasPictorialRepresentation}">
                            <p:ajax listener="#{complianceManager.updateJob}"/>
                        </p:selectBooleanCheckbox>     

                    </h:panelGrid>
                    <ui:remove>
                        <hr/>
                        <h:panelGrid columns="2">
                            <h:outputText value="Product image: " />
                            <h:panelGroup>
                                <h:panelGrid columns="2">
                                    <p:inputText value="#{complianceManager.currentMarketProduct.imageURL}"
                                                 id="imageURL"
                                                 readonly="true"
                                                 style="font-weight: bold;width: 300px" >
                                        <p:ajax event="keyup"
                                                global="false"
                                                listener="#{complianceManager.updateJob}"
                                                process="@this"/>                           
                                    </p:inputText>

                                    <p:commandButton id="downloadImageButton" value="Download" ajax="false" 
                                                     onclick="longProcessDialogVar2.show();"   
                                                     disabled="#{!complianceManager.marketProductImageIsValid}"
                                                     icon="ui-icon-arrowthichk-s">  
                                        <p:fileDownload value="#{complianceManager.getCurrentMarketProductImageDownload}" />
                                    </p:commandButton> 
                                </h:panelGrid>

                                <p:fileUpload fileUploadListener="#{complianceManager.handleProductPhotoFileUpload}" 
                                              onstart="longProcessDialogVar.show();"
                                              oncomplete="longProcessDialogVar.hide();"
                                              multiple="false"
                                              update="imageURL,downloadImageButton"
                                              allowTypes="/(\.|\/)(gif|jpe?g|png)$/" />


                            </h:panelGroup>
                        </h:panelGrid>
                    </ui:remove>
                </p:tab>

            </p:tabView>
            <hr/>
            <p:commandButton value="Ok"
                             actionListener="#{complianceManager.okMarketProduct}"
                             onstart="longProcessDialogVar.show();"
                             oncomplete="productDialog.hide();longProcessDialogVar.hide();productDialogTabViewVar.select(0);"
                             update="#{complianceManager.productTablesToUpdate}"
                             icon="ui-icon ui-icon-check"
                             process="@form"/>

            <p:commandButton value="Cancel"
                             onstart="longProcessDialogVar.show();"
                             oncomplete="productDialog.hide();longProcessDialogVar.hide();productDialogTabViewVar.select(0);"                            
                             icon="ui-icon ui-icon-cancel"/>

        </p:dialog>
    </h:form>

    <h:form>
        <p:confirmDialog severity="alert"
                         closable="false"
                         message="Are you sure you wish to delete this product?"
                         header="Delete Product?"
                         widgetVar="deleteProductDialog"
                         width="400">
            <p:commandButton value="Yes"
                             actionListener="#{complianceManager.removeMarketProduct}"
                             update="#{complianceManager.productTablesToUpdate}"
                             oncomplete="deleteProductDialog.hide();"
                             icon="ui-icon-check"/>
            <p:commandButton value="No"
                             oncomplete="deleteProductDialog.hide();"
                             icon="ui-icon-cancel"/>
        </p:confirmDialog>
    </h:form>

</html>
