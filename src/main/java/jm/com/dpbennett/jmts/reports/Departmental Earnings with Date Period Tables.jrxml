<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Departmental Earnings" language="groovy" pageWidth="800" pageHeight="1200" columnWidth="760" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" isIgnorePagination="true" uuid="2968f87d-e793-471b-a0e2-11b9ce11246e">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="139"/>
	<style name="table">
		<box>
			<pen lineWidth="1.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_CH" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<subDataset name="Date Period 1 Dataset" uuid="e462431c-3fd8-41c3-962a-630b1b136416">
		<parameter name="datePeriodStart1" class="java.util.Date" isForPrompting="false">
			<defaultValueExpression><![CDATA[]]></defaultValueExpression>
		</parameter>
		<parameter name="datePeriodEnd1" class="java.util.Date" isForPrompting="false">
			<defaultValueExpression><![CDATA[]]></defaultValueExpression>
		</parameter>
		<queryString>
			<![CDATA[SELECT
     CASE WHEN jobsubcategory.`SubCategory` LIKE '--'THEN 'Uncategorized'ELSE jobsubcategory.`SubCategory` END AS jobsubcategory_SubCategory,
     GROUP_CONCAT(job.`JOBNUMBER` SEPARATOR ', ') AS 'Job_Numbers',
     jobstatusandtracking.`DATEOFCOMPLETION` AS Date_Period,
     SUM(jobcostingandpayment.`FINALCOST`) AS Earnings,
     department.`SUBGROUPCODE` AS department_SUBGROUPCODE,
     department.`NAME` AS department_NAME,
     GROUP_CONCAT(department_A.`SUBGROUPCODE` SEPARATOR ', ') AS department_A_SUBGROUPCODE
FROM
     `department` department INNER JOIN `job` job ON department.`ID` = job.`DEPARTMENT_ID`
     INNER JOIN `jobsubcategory` jobsubcategory ON job.`JOBSUBCATEGORY_ID` = jobsubcategory.`ID`
     INNER JOIN `jobstatusandtracking` jobstatusandtracking ON job.`JOBSTATUSANDTRACKING_ID` = jobstatusandtracking.`ID`
     INNER JOIN `jobcostingandpayment` jobcostingandpayment ON job.`JOBCOSTINGANDPAYMENT_ID` = jobcostingandpayment.`ID`
     INNER JOIN `department` department_A ON job.`SUBCONTRACTEDDEPARTMENT_ID` = department_A.`ID`
WHERE
     (department.`NAME` LIKE 'Chemistry'
  OR department.`NAME` LIKE 'Electrical%'
  OR department.`NAME` LIKE 'Civil%'
  OR department.`NAME` LIKE 'Micro%'
  OR department.`NAME` LIKE 'Mechanical%')
 AND jobstatusandtracking.`DATEOFCOMPLETION` >= $P{datePeriodStart1}
 AND jobstatusandtracking.`DATEOFCOMPLETION` <= $P{datePeriodEnd1}
 AND jobsubcategory.`IsEarning` = 1
 AND (department_A.`SUBGROUPCODE` = 0 OR department_A.`SUBGROUPCODE` IS NULL)
GROUP BY
     Date_Period,
     jobsubcategory_SubCategory
ORDER BY
     department_NAME ASC,
     jobsubcategory_SubCategory ASC,
     Date_Period ASC]]>
		</queryString>
		<field name="jobsubcategory_SubCategory" class="java.lang.String"/>
		<field name="Job_Numbers" class="java.lang.String"/>
		<field name="Date_Period" class="java.sql.Date"/>
		<field name="Earnings" class="java.lang.Double"/>
		<field name="department_SUBGROUPCODE" class="java.lang.String"/>
		<field name="department_NAME" class="java.lang.String"/>
		<field name="department_A_SUBGROUPCODE" class="java.lang.String"/>
	</subDataset>
	<parameter name="datePeriodStart1" class="java.util.Date" isForPrompting="false">
		<defaultValueExpression><![CDATA[new SimpleDateFormat("yyyy-MM-dd").parse("2014-04-01")]]></defaultValueExpression>
	</parameter>
	<parameter name="datePeriodEnd1" class="java.util.Date" isForPrompting="false">
		<defaultValueExpression><![CDATA[new SimpleDateFormat("yyyy-MM-dd").parse("2015-03-31")]]></defaultValueExpression>
	</parameter>
	<parameter name="datePeriodStart2" class="java.util.Date" isForPrompting="false">
		<defaultValueExpression><![CDATA[new SimpleDateFormat("yyyy-MM-dd").parse("2015-04-01")]]></defaultValueExpression>
	</parameter>
	<parameter name="datePeriodEnd2" class="java.util.Date" isForPrompting="false">
		<defaultValueExpression><![CDATA[new SimpleDateFormat("yyyy-MM-dd").parse("2016-03-31")]]></defaultValueExpression>
	</parameter>
	<parameter name="datePeriodStart3" class="java.util.Date" isForPrompting="false">
		<defaultValueExpression><![CDATA[new SimpleDateFormat("yyyy-MM-dd").parse("2016-04-01")]]></defaultValueExpression>
	</parameter>
	<parameter name="datePeriodEnd3" class="java.util.Date" isForPrompting="false">
		<defaultValueExpression><![CDATA[new SimpleDateFormat("yyyy-MM-dd").parse("2017-03-31")]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT
     CASE WHEN jobsubcategory.`SubCategory` LIKE '--'THEN 'Uncategorized'ELSE jobsubcategory.`SubCategory` END AS jobsubcategory_SubCategory,
     GROUP_CONCAT(job.`JOBNUMBER` SEPARATOR ', ') AS 'Job_Numbers',
     CASE WHEN(jobstatusandtracking.`DATEOFCOMPLETION` >=$P{datePeriodStart1}AND jobstatusandtracking.`DATEOFCOMPLETION` <=$P{datePeriodEnd1})THEN 'Date Period 1'WHEN(jobstatusandtracking.`DATEOFCOMPLETION` >=$P{datePeriodStart2}AND jobstatusandtracking.`DATEOFCOMPLETION` <=$P{datePeriodEnd2})THEN 'Date Period 2'WHEN(jobstatusandtracking.`DATEOFCOMPLETION` >=$P{datePeriodStart3}AND jobstatusandtracking.`DATEOFCOMPLETION` <=$P{datePeriodEnd3})THEN 'Date Period 3'END AS Date_Period,
     SUM(jobcostingandpayment.`FINALCOST`) AS Earnings,
     department.`SUBGROUPCODE` AS department_SUBGROUPCODE,
     department.`NAME` AS department_NAME,
     GROUP_CONCAT(department_A.`SUBGROUPCODE` SEPARATOR ', ') AS department_A_SUBGROUPCODE
FROM
     `department` department INNER JOIN `job` job ON department.`ID` = job.`DEPARTMENT_ID`
     INNER JOIN `jobsubcategory` jobsubcategory ON job.`JOBSUBCATEGORY_ID` = jobsubcategory.`ID`
     INNER JOIN `jobstatusandtracking` jobstatusandtracking ON job.`JOBSTATUSANDTRACKING_ID` = jobstatusandtracking.`ID`
     INNER JOIN `jobcostingandpayment` jobcostingandpayment ON job.`JOBCOSTINGANDPAYMENT_ID` = jobcostingandpayment.`ID`
     INNER JOIN `department` department_A ON job.`SUBCONTRACTEDDEPARTMENT_ID` = department_A.`ID`
WHERE
     (department.`NAME` LIKE 'Chemistry'
  OR department.`NAME` LIKE 'Electrical%'
  OR department.`NAME` LIKE 'Civil%'
  OR department.`NAME` LIKE 'Micro%'
  OR department.`NAME` LIKE 'Mechanical%')
 AND ((jobstatusandtracking.`DATEOFCOMPLETION` >= $P{datePeriodStart1}
 AND jobstatusandtracking.`DATEOFCOMPLETION` <= $P{datePeriodEnd1})
  OR (jobstatusandtracking.`DATEOFCOMPLETION` >= $P{datePeriodStart2}
 AND jobstatusandtracking.`DATEOFCOMPLETION` <= $P{datePeriodEnd2})
  OR (jobstatusandtracking.`DATEOFCOMPLETION` >= $P{datePeriodStart3}
 AND jobstatusandtracking.`DATEOFCOMPLETION` <= $P{datePeriodEnd3}))
 AND jobsubcategory.`IsEarning` = 1
 AND jobsubcategory.`active` = 1
 AND (department_A.`SUBGROUPCODE` = 0 OR department_A.`SUBGROUPCODE` IS NULL)
GROUP BY
     Date_Period,
     jobsubcategory_SubCategory
ORDER BY
     department_NAME ASC,
     jobsubcategory_SubCategory ASC,
     Date_Period ASC]]>
	</queryString>
	<field name="jobsubcategory_SubCategory" class="java.lang.String"/>
	<field name="Job_Numbers" class="java.lang.String"/>
	<field name="Date_Period" class="java.lang.String"/>
	<field name="Earnings" class="java.lang.Double"/>
	<field name="department_SUBGROUPCODE" class="java.lang.String"/>
	<field name="department_NAME" class="java.lang.String"/>
	<field name="department_A_SUBGROUPCODE" class="java.lang.String"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="163" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="960" height="30" forecolor="#000033" uuid="260c2041-5dc2-4658-b962-0b22a91afa83"/>
				<textElement>
					<font size="20" isBold="true"/>
				</textElement>
				<text><![CDATA[Bureau of Standards Jamaica]]></text>
			</staticText>
			<staticText>
				<reportElement x="2" y="30" width="958" height="20" forecolor="#330033" uuid="28b8f081-bcc4-4654-802e-4ea6d6cced2a"/>
				<textElement>
					<font size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[Department Earnings]]></text>
			</staticText>
			<staticText>
				<reportElement x="1" y="58" width="101" height="20" forecolor="#003366" uuid="cdfdb7a2-cc43-461e-8286-b48f1be3d8fa"/>
				<textElement verticalAlignment="Middle">
					<font size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Date period 1:]]></text>
			</staticText>
			<staticText>
				<reportElement x="1" y="88" width="101" height="20" forecolor="#003366" uuid="3dbba1b3-34df-4536-b42b-4b2e2a34c5bf"/>
				<textElement verticalAlignment="Middle">
					<font size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Date period 2:]]></text>
			</staticText>
			<staticText>
				<reportElement x="1" y="118" width="101" height="20" forecolor="#003366" uuid="b9dab203-2c2b-4b50-89b1-bf32e47b52b9"/>
				<textElement verticalAlignment="Middle">
					<font size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Date period 3:]]></text>
			</staticText>
			<textField pattern="MMM dd, yyyy">
				<reportElement x="102" y="58" width="106" height="20" forecolor="#003366" uuid="d5541b55-03dd-442a-a95f-63bf77c1e71b"/>
				<textElement verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{datePeriodStart1}]]></textFieldExpression>
			</textField>
			<textField pattern="MMM dd, yyyy">
				<reportElement x="102" y="88" width="106" height="20" forecolor="#003366" uuid="cec39623-6095-42cf-8f97-d812d2723b4d"/>
				<textElement verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{datePeriodStart2}]]></textFieldExpression>
			</textField>
			<textField pattern="MMM dd, yyyy">
				<reportElement x="102" y="118" width="106" height="20" forecolor="#003366" uuid="bbe729b9-4a34-4abe-8eb7-7fe40081200b"/>
				<textElement verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{datePeriodStart3}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="208" y="58" width="40" height="20" forecolor="#003366" uuid="166b02bb-1985-458f-9cd9-01fc97729241"/>
				<textElement verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<text><![CDATA[to]]></text>
			</staticText>
			<textField pattern="MMM dd, yyyy">
				<reportElement x="248" y="58" width="112" height="20" forecolor="#003366" uuid="1d9e7dd5-221f-4cdb-ac3d-9cbb74d6c008"/>
				<textElement verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{datePeriodEnd1}]]></textFieldExpression>
			</textField>
			<textField pattern="MMM dd, yyyy">
				<reportElement x="248" y="88" width="112" height="20" forecolor="#003366" uuid="b7b9be0f-7da1-4e34-9cd8-59153ef86048"/>
				<textElement verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{datePeriodEnd2}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="208" y="88" width="40" height="20" forecolor="#003366" uuid="264121fa-3af6-489c-886f-fae6a211344e"/>
				<textElement verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<text><![CDATA[to]]></text>
			</staticText>
			<textField pattern="MMM dd, yyyy">
				<reportElement x="248" y="118" width="112" height="20" forecolor="#003366" uuid="b69ec283-ef11-466a-ae8e-505fa077c513"/>
				<textElement verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{datePeriodEnd3}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="208" y="118" width="40" height="20" forecolor="#003366" uuid="bdb72d5e-16d5-40d8-a42d-19b63ebbcf8a"/>
				<textElement verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<text><![CDATA[to]]></text>
			</staticText>
		</band>
	</title>
	<columnHeader>
		<band height="29" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="258" height="29" uuid="d2db3155-6d35-4e89-b8e1-a016dee45e76"/>
				<textElement verticalAlignment="Middle">
					<font size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Department (Parent)]]></text>
			</staticText>
			<staticText>
				<reportElement x="258" y="0" width="213" height="29" uuid="f24b8823-7d55-4097-8501-3e2c8b774a5e"/>
				<textElement verticalAlignment="Middle">
					<font size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Earnings Category]]></text>
			</staticText>
			<staticText>
				<reportElement x="471" y="0" width="129" height="29" uuid="90097a0f-1d76-43a1-8bb5-562bc8ec6f70"/>
				<textElement verticalAlignment="Middle">
					<font size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Date Period]]></text>
			</staticText>
			<staticText>
				<reportElement x="600" y="0" width="134" height="29" uuid="4da3f2f9-638c-4102-81f4-8035f3401168"/>
				<textElement verticalAlignment="Middle">
					<font size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Earnings]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="29" splitType="Stretch">
			<textField>
				<reportElement isPrintRepeatedValues="false" x="2" y="0" width="256" height="29" uuid="f41e42c3-02d9-4bbc-b933-fce93c85a4ce"/>
				<textElement>
					<font size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{department_NAME}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement isPrintRepeatedValues="false" x="258" y="0" width="213" height="29" uuid="cdb1b737-96e0-492e-942c-62042ff9abf5"/>
				<textElement>
					<font size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{jobsubcategory_SubCategory}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement x="471" y="0" width="129" height="29" uuid="0a5e371f-f85a-463b-ad7b-39c625185fd9"/>
				<textElement>
					<font size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{Date_Period}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="¤ #,##0.00">
				<reportElement x="600" y="0" width="134" height="29" uuid="e0a0445a-7583-49fc-9f72-28615798f391"/>
				<textElement>
					<font size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{Earnings}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="630" splitType="Stretch">
			<staticText>
				<reportElement x="2" y="0" width="758" height="29" uuid="9a1e8b8c-70fe-4524-8c4b-090ec1523f7b"/>
				<textElement>
					<font size="16" isBold="true"/>
				</textElement>
				<text><![CDATA[Departmental Earnings by Category]]></text>
			</staticText>
			<componentElement>
				<reportElement key="table" style="table" x="2" y="29" width="295" height="50" uuid="47febfeb-50db-47ef-9d98-889736cf1bc6"/>
				<jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd">
					<datasetRun subDataset="Date Period 1 Dataset" uuid="7bbe04de-8af7-4773-9e59-1775f405b4f2">
						<datasetParameter name="datePeriodStart1">
							<datasetParameterExpression><![CDATA[$P{datePeriodStart1}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="datePeriodEnd1">
							<datasetParameterExpression><![CDATA[$P{datePeriodEnd1}]]></datasetParameterExpression>
						</datasetParameter>
						<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					</datasetRun>
					<jr:column width="90" uuid="a2a7dd41-f48e-48cf-9a63-ade3fb92d588">
						<jr:columnHeader style="table_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="90" height="30" uuid="ea9d314b-758c-40b4-8d6c-88e51326b820"/>
								<text><![CDATA[Date_Period]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="20">
							<textField>
								<reportElement x="0" y="0" width="90" height="20" uuid="b01330d9-fe9c-4502-9dab-79c4fdbef5a8"/>
								<textFieldExpression><![CDATA[$F{Date_Period}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="9ec39f24-099b-47d4-a36e-d09a5de074a2">
						<jr:columnHeader style="table_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="90" height="30" uuid="7114416a-cb94-498b-93f9-3b5ef20c1f01"/>
								<text><![CDATA[jobsubcategory_SubCategory]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="20">
							<textField>
								<reportElement x="0" y="0" width="90" height="20" uuid="31152a65-00cc-467f-bad6-e5c1fde0bd17"/>
								<textFieldExpression><![CDATA[$F{jobsubcategory_SubCategory}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="befe52ea-2e7d-42e3-8694-dd975ca109ce">
						<jr:columnHeader style="table_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="90" height="30" uuid="fe12d180-d8e1-4a6a-8116-65b63527dbbe"/>
								<text><![CDATA[Earnings]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="20">
							<textField>
								<reportElement x="0" y="0" width="90" height="20" uuid="b9961542-1292-486e-ab28-1535efd04bbe"/>
								<textFieldExpression><![CDATA[$F{Earnings}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
				</jr:table>
			</componentElement>
		</band>
	</summary>
</jasperReport>
