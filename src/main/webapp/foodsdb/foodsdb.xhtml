<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets">
    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />
        <title>Food Inspectorate Database Portal</title>
        <style type="text/css">
            .ui-widget {
                font-size: 80%;
            }
            .jobNumberClass {
                width: 100%;
                color: orange;
            }      
            .hold {
                color: red;
                font-size: 1.2em;
                background-image: none;
                font-weight: bolder;
            }
            .active {
                color: green;
                font-size: 1.2em;
                background-image: none;
                font-weight: bolder;
            }       
            .overdue {
                background-color: yellow;
                background-image: none;
                color: #000000;
            }
            .header {
                background-color: gray;
                background-image: none;
                color: white;
            }
            .rdonly {
                background-color: lightgrey;
                background-image: none;
                color: blue;
            }
        </style>
        <script type="text/javascript" src="foodsdbJavascript.js" />

    </h:head>
    <h:body>
        <ui:insert>
            <ui:include src="foodsdbAlertDialogs.xhtml"/>
            <ui:include src="loginDialog.xhtml"/>
            <ui:remove>
                <ui:include src="accPacClientInformationDialog.xhtml"/>
            </ui:remove>
            <ui:include src="longProcessDialog.xhtml"/>
            <ui:include src="foodFactoryDialog.xhtml"/>
            <ui:include src="addressDialog.xhtml"/>
            <ui:include src="contactDialog.xhtml"/>
            <ui:include src="factoryProductsDialog.xhtml"/>
            <ui:include src="factoryRegistrationDialogs.xhtml"/>
            <ui:include src="factoryCertificationDialogs.xhtml"/>
            <ui:include src="factoryInspectionDialog.xhtml"/>
        </ui:insert>
        <p:layout id="JMTSWeb" fullPage="true" widgetVar="layoutVar">

            <p:layoutUnit position="north" header="Food Inspectorate Database Portal" >
                <h:form id="headerForm">
                    <table border="0" width="100%">
                        <tr>
                            <td>
                                <img src="BSJ Logo.jpg" width="272" height="41" alt="BSJ Logo"/>
                            </td>

                            <td align="left">
                                <h:outputText value="Food Inspectorate Database Portal"
                                              style="color: gray; font-size: 14pt; font-weight: bold" />
                            </td>

                            <td align="right">
                                <p:commandButton style="font-weight: bold"
                                                 actionListener="#{jobManager.logout}"
                                                 oncomplete="loginDialog.show();"
                                                 update="headerForm,:loginForm"
                                                 icon="ui-icon-person"
                                                 value="Logout: #{jobManager.user.employee.firstName} #{jobManager.user.employee.lastName}" />
                            </td>
                        </tr>
                    </table>

                    <p:remoteCommand name="updateHeaderForm"
                                     update="headerForm"
                                     process="@this"/>



                </h:form>
            </p:layoutUnit>

            <p:layoutUnit position="center" >
                <h:form id="entryForm" >
                    <p:toolbar>
                        <p:toolbarGroup align="left" >

                            <p:commandButton                                
                                value="New"
                                title="New factory"
                                actionListener="#{jobManager.createNewFoodFactory}"
                                update=":foodFactoryDialogForm"
                                oncomplete="foodFactoryDialog.show();"
                                icon="ui-icon-plusthick"
                                process="@this"/>
                            <p:separator/>
                            <h:panelGroup >                                
                                <p:autoComplete value="#{jobManager.searchText}"
                                                id="factorySearchText"
                                                disabled="#{jobManager.searchTextDisabled}"
                                                completeMethod="#{jobManager.completeSearchText}"/>
                                <p:watermark value="-- enter search text --" for="factorySearchText" />
                                <p:spacer height="0" width="10"/>
                                <p:commandButton value="Search"
                                                 id="factorySearchButton"
                                                 onstart="longProcessDialogVar.show();"
                                                 actionListener="#{jobManager.doEntitySearch}"
                                                 update=":factoriessDatabaseForm"
                                                 oncomplete="longProcessDialogVar.hide();"
                                                 icon="ui-icon-search"
                                                 process="@form"/>
                            </h:panelGroup>
                            <p:spacer height="0" width="200"/>

                        </p:toolbarGroup>

                        <ui:remove>
                            <p:toolbarGroup align="right" >
                                <p:menuButton id="toolsMenuButton" value="Tools" >
                                    <ui:remove>
                                        <p:menuitem actionListener="#{jobManager.updateAccPacClient}"
                                                    onstart="longProcessDialogVar.show();"
                                                    value="Credit status"
                                                    update=":accPacClientInformationTabView:accPacClientCreditStatusForm"
                                                    oncomplete="accPacClientInformationDialog.show();longProcessDialogVar.hide();"
                                                    process="@this"/>
                                    </ui:remove>
                                    <p:menuitem onstart="longProcessDialogVar.show();"
                                                value="Reporting"
                                                oncomplete="longProcessDialogVar.hide();"
                                                process="@this"/>
                                    <p:menuitem onstart="longProcessDialogVar.show();"
                                                value="Queries"
                                                oncomplete="longProcessDialogVar.hide();"
                                                process="@this"/>                                 
                                </p:menuButton>
                            </p:toolbarGroup>
                        </ui:remove>

                    </p:toolbar>

                    <p:defaultCommand target="factorySearchButton" />
                </h:form>
                <hr/>
                <h:form id="factoriessDatabaseForm" >

                    <ui:insert>
                        <ui:include src="foodFactoriesDatabaseTable.xhtml"/>
                    </ui:insert>

                    <p:remoteCommand name="keepAliveRequest"
                                     actionListener="#{jobManager.handleKeepAlive}"
                                     onerror="connectionErrorDialog.show();"
                                     update="@this"
                                     process="@this"/>

                </h:form>
            </p:layoutUnit>

            <p:layoutUnit
                id="searchLayoutUnit"
                position="west" size="340"
                header="Search"
                resizable="true"
                rendered="false"
                collapsible="true">
                <ui:insert>
                    <ui:include src="searchForm.xhtml"/>
                </ui:insert>

            </p:layoutUnit>

        </p:layout>

    </h:body>
</html>

