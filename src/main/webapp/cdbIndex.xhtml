<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"> 
    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />
        <title>Compliance Connect</title>
        <style type="text/css">
            .ui-widget {
                font-size: 80%;
            }
            .jobNumberClass {
                width: 100%;
                color: orange;
            }      
            .hold {
                color: red;
                font-size: 1.2em;
                background-image: none;
                font-weight: bolder;
            }
            .active {
                color: green;
                font-size: 1.2em;
                background-image: none;
                font-weight: bolder;
            }       
            .overdue {
                background-color: yellow;
                background-image: none;
                color: #000000;
            }
            .header {
                background-color: gray;
                background-image: none;
                color: white;
            }
            .rdonly {
                background-color: lightgrey;
                background-image: none;
                color: blue;
            }
        </style>
        <script type="text/javascript" src="js/cdbJavascript.js" />
        <script type="text/javascript" src="js/commonJavascript.js" />
    </h:head>
    <h:body>
        <ui:insert >
            <ui:include src="common/commonDialogs.xhtml"/>
            <ui:include src="cdb/cdbLongProcessDialog.xhtml"/>
            <ui:include src="common/loginDialog.xhtml"/>
            <ui:include src="common/clientForm.xhtml"/>           
            <ui:include src="cdb/cdbProductInspectionDialogs.xhtml"/>           
            <ui:include src="cdb/cdbComplianceSurveyDialogs.xhtml"/>                
            <ui:include src="cdb/cdbAlertDialogs.xhtml"/>
        </ui:insert>
        <p:layout id="ComplianceWeb" fullPage="true" widgetVar="layoutVar">
            <p:layoutUnit position="north" header="Compliance Connect" >
                <ui:remove>
                    <marquee style="color:red;font-weight: bold;" loop="-1" direction="right" scrollamount="5" width="100%">>>>>>>> ALERT PLEASE LOOK OUT FOR >>>>>></marquee>
                    <br/>
                    <marquee style="color:red;font-weight: bold;" loop="-1" scrollamount="5" width="100%">#{complianceManager.latestAlert}</marquee>
                    <hr/>
                </ui:remove>
                <h:form id="headerForm">
                    <table border="0" width="100%">
                        <tr>
                            <td>
                                <img src="images/BSJ-Logo.jpg" width="272" height="41" alt="BSJ Logo"/>
                            </td>

                            <td align="left">
                                <h:outputText value="Compliance Connect"
                                              style="color: gray; font-size: 14pt; font-weight: bold" />
                            </td>

                            <td align="right">
                                <p:commandButton style="font-weight: bold"
                                                 actionListener="#{complianceManager.logout}"
                                                 oncomplete="loginDialog.show();"
                                                 update=":headerForm,:entryForm,:loginForm,:mainTabViewForm:mainTabView:complianceSurveysTable"
                                                 icon="ui-icon-person"
                                                 value="Logout: #{complianceManager.main.user.employee.firstName} #{complianceManager.main.user.employee.lastName}" />
                            </td>

                        </tr>
                    </table>

                </h:form>
            </p:layoutUnit>


            <p:layoutUnit position="center" >

                <p:idleMonitor timeout="600000"
                               onidle="logOut();"/>  


                <h:form id="entryForm" >

                    <p:remoteCommand name="keepAliveRequest" 
                                     actionListener="#{complianceManager.handleKeepAlive}"
                                     onerror="connectionErrorDialog.show();"
                                     update="@this"
                                     process="@this"/>

                    <ui:remove>
                        <p:remoteCommand name="logOut" 
                                         actionListener="#{complianceManager.autoLogout}"
                                         onerror="connectionErrorDialog.show();"
                                         oncomplete="window.location.reload();loginDialog.show();"
                                         update=":headerForm,:loginForm"                                    
                                         process="@this"/>
                    </ui:remove>

                    <p:toolbar>
                        <p:toolbarGroup align="left" >
                            <h:panelGroup >                                
                                <p:autoComplete value="#{complianceManager.searchText}"
                                                id="searchText"                                                
                                                completeMethod="#{complianceManager.completeSearchText}"/>
                                <p:watermark value="-- enter search text --" for="searchText" />
                                <p:spacer height="0" width="10"/>
                                <p:commandButton value="Search"
                                                 id="searchButton"
                                                 onstart="longProcessDialogVar.show();"
                                                 onerror="connectionErrorDialog.show();" 
                                                 actionListener="#{complianceManager.doEntitySearch}"
                                                 oncomplete="checkForConnectionLife(xhr,status,args);"
                                                 icon="ui-icon-search"
                                                 process="@form"/>
                            </h:panelGroup>
                            <p:spacer height="0" width="100"/>                                   

                        </p:toolbarGroup>
                        
                    </p:toolbar>

                    <p:defaultCommand target="searchButton" />
                </h:form>
                <hr/>

                <h:form id="mainTabViewForm">
                    <p:tabView id="mainTabView" dynamic="true">
                        <p:ajax event="tabChange"    
                                onstart="longProcessDialogVar.show();"
                                oncomplete="longProcessDialogVar.hide();" />

                        <p:tab title="Compliance Survey" >
                            <center><font color="green" size="4" face="TIMES NEW ROMAN">Compliance Surveys</font> </center>
                            <hr align="CENTER/RIGHT" style="background-color: green" size="5" width="100%"/>

                            <ui:insert>
                                <ui:include src="cdb/cdbComplianceSurvey.xhtml"/>
                            </ui:insert>

                        </p:tab>

                    </p:tabView>
                </h:form>
            </p:layoutUnit>
        </p:layout>
    </h:body>
</html>

