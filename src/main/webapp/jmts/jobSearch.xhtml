<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">

    <h:panelGrid columns="2">

        <h:outputText value="Search type: " />
        <p:selectOneMenu value="#{searchManager.currentSearchParameters.searchType}" 
                         style="width: 146px" >
            <p:ajax                        
                listener="#{searchManager.updateSearchType}"
                process="@this" />
            <f:selectItems value="#{searchManager.authorizedSearchTypes}" />
        </p:selectOneMenu>

        <h:outputText value="Date field: " 
                      rendered="#{searchManager.currentSearchParameters.showDateField}"/>
        <p:selectOneMenu value="#{searchManager.currentSearchParameters.dateField}" 
                         rendered="#{searchManager.currentSearchParameters.showDateField}" 
                         style="width: 146px" >
            <p:ajax                        
                listener="#{searchManager.updateDateField}"
                process="@this" />
            <f:selectItems value="#{searchManager.currentSearchParameters.searchDateFields}" />
        </p:selectOneMenu>

        <h:outputText value="Date period: " rendered="#{searchManager.currentSearchParameters.showDateField}"/>               
        <p:selectOneMenu value= "#{searchManager.currentSearchParameters.datePeriod.name}" 
                         rendered="#{searchManager.currentSearchParameters.showDateField}"
                         style="width: 146px" >
            <p:ajax listener="#{searchManager.changeSearchDatePeriod}"
                    update="startSearchDate,endSearchDate"
                    process="@this" />
            <f:selectItems value="#{App.datePeriods}"/>
        </p:selectOneMenu>
        <h:outputText value="Start:" 
                      rendered="#{searchManager.currentSearchParameters.showDateField}" />
        <p:calendar id="startSearchDate"
                    value="#{searchManager.currentSearchParameters.datePeriod.startDate}"                    
                    size="16"
                    navigator="true"
                    rendered="#{searchManager.currentSearchParameters.showDateField}"
                    disabled="#{searchManager.currentSearchParameters.datePeriod.startDateDisabled}"
                    pattern="MMM dd, yyyy" >
            <p:ajax event="dateSelect"                            
                    listener="#{searchManager.handleStartDateSelect(event)}"/>
            <p:ajax event="keyup"                            
                    listener="#{searchManager.handleStartDateSelect(event)}"/>
        </p:calendar>

        <h:outputText value="End:" 
                      rendered="#{searchManager.currentSearchParameters.showDateField}" />
        <p:calendar id="endSearchDate"
                    rendered="#{searchManager.currentSearchParameters.showDateField}"
                    value="#{searchManager.currentSearchParameters.datePeriod.endDate}"
                    size="16"
                    navigator="true"
                    disabled="#{searchManager.currentSearchParameters.datePeriod.endDateDisabled}"
                    pattern="MMM dd, yyyy" >
            <p:ajax event="dateSelect"                           
                    listener="#{searchManager.handleEndDateSelect(event)}"/>
            <p:ajax event="keyup"                           
                    listener="#{searchManager.handleEndDateSelect(event)}"/>
        </p:calendar>
        <p:spacer height="10" /> <p:spacer height="10" />
        <p:inputText value="#{searchManager.currentSearchParameters.searchText}"  
                     style="width: 125px"
                     id="searchText"/>        
        <p:commandButton value="Search"
                         id="doSearch"
                         onstart="longProcessDialogVar.show();"
                         actionListener="#{searchManager.doSearch}"
                         onerror="connectionErrorDialog.show();"
                         update=":headerForm:growl3"
                         icon="ui-icon-search"
                         process="@form"/>
    </h:panelGrid>
    <p:watermark value="-- enter search text --" for="searchText" />
    <hr/>
    <p/>
</html>
