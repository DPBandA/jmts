SELECT
     COUNT(job.`NOOFTESTSORCALIBRATIONS`) AS job_NOOFTESTSORCALIBRATIONS,
     COUNT(job.`NUMBEROFSAMPLES`) AS job_NUMBEROFSAMPLES,
     GROUP_CONCAT(jobsample.`DESCRIPTION` SEPARATOR ' ') AS samples,
     GROUP_CONCAT(sector.`NAME` SEPARATOR ', ') AS sectors,
     job.`ID` AS job_ID,
     job.`JOBCOSTINGANDPAYMENT_ID` AS job_JOBCOSTINGANDPAYMENT_ID,
     department.`ID` AS department_ID,
     department.`NAME` AS department_NAME,
     department.`ACTIVE` AS department_ACTIVE,
     jobstatusandtracking.`ID` AS jobstatusandtracking_ID,
     jobstatusandtracking.`DATESUBMITTED` AS jobstatusandtracking_DATESUBMITTED,
     jobsubcategory.`ID` AS jobsubcategory_ID,
     jobsubcategory.`IsEarning` AS jobsubcategory_IsEarning,
     jobsubcategory.`ACTIVE` AS jobsubcategory_ACTIVE,
     department.`SUBGROUPCODE` AS department_SUBGROUPCODE,
     department_A.`ID` AS department_A_ID,
     department_A.`NAME` AS department_A_NAME,
     department_A.`ACTIVE` AS department_A_ACTIVE,
     client.`ID` AS client_ID,
     client.`NAME` AS client_NAME,
     job.`CLIENT_ID` AS job_CLIENT_ID,
     jobsample.`ID` AS jobsample_ID,
     jobsample.`DESCRIPTION` AS jobsample_DESCRIPTION,
     job_jobsample.`Job_ID` AS job_jobsample_Job_ID,
     job_jobsample.`jobSamples_ID` AS job_jobsample_jobSamples_ID,
     sector.`ID` AS sector_ID,
     sector.`NAME` AS sector_NAME
FROM
     `department` department INNER JOIN `job` job ON department.`ID` = job.`DEPARTMENT_ID`
     INNER JOIN `jobstatusandtracking` jobstatusandtracking ON job.`JOBSTATUSANDTRACKING_ID` = jobstatusandtracking.`ID`
     INNER JOIN `jobsubcategory` jobsubcategory ON job.`JOBSUBCATEGORY_ID` = jobsubcategory.`ID`
     INNER JOIN `department` department_A ON job.`SUBCONTRACTEDDEPARTMENT_ID` = department_A.`ID`
     INNER JOIN `client` client ON job.`CLIENT_ID` = client.`ID`
     INNER JOIN `job_jobsample` job_jobsample ON job.`ID` = job_jobsample.`Job_ID`
     INNER JOIN `sector` sector ON job.`SECTOR_ID` = sector.`ID`
     INNER JOIN `jobsample` jobsample ON job_jobsample.`jobSamples_ID` = jobsample.`ID`
WHERE
     jobstatusandtracking.`DATESUBMITTED` >= $P{startOFPeriod}
 AND jobstatusandtracking.`DATESUBMITTED` <= $P{endOFPeriod}
 AND jobsubcategory.`IsEarning` = 1
 AND department_A.`NAME` = "--"
 AND (department.`SUBGROUPCODE` = 25
  OR department.`SUBGROUPCODE` = 27
  OR department.`SUBGROUPCODE` = 21
  OR department.`SUBGROUPCODE` = 15
  OR department.`SUBGROUPCODE` = 25
  OR department.`SUBGROUPCODE` = 27
  OR department.`SUBGROUPCODE` = 50
  OR department.`SUBGROUPCODE` = 56
  OR department.`SUBGROUPCODE` = 46
  OR department.`SUBGROUPCODE` = 43
  OR department.`SUBGROUPCODE` = 45
  OR department.`SUBGROUPCODE` = 44
  OR department.`SUBGROUPCODE` = 42
  OR department.`SUBGROUPCODE` = 22
  OR department.`SUBGROUPCODE` = 26
  OR department.`SUBGROUPCODE` = 28
  OR department.`SUBGROUPCODE` = 30
  OR department.`SUBGROUPCODE` = 18)
GROUP BY
     client.`NAME`
ORDER BY
      department.`NAME` ASC
